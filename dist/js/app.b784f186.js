(function(e){function t(t){for(var o,l,a=t[0],i=t[1],s=t[2],d=0,m=[];d<a.length;d++)l=a[d],Object.prototype.hasOwnProperty.call(n,l)&&n[l]&&m.push(n[l][0]),n[l]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);p&&p(t);while(m.length)m.shift()();return c.push.apply(c,s||[]),r()}function r(){for(var e,t=0;t<c.length;t++){for(var r=c[t],o=!0,a=1;a<r.length;a++){var i=r[a];0!==n[i]&&(o=!1)}o&&(c.splice(t--,1),e=l(l.s=r[0]))}return e}var o={},n={app:0},c=[];function l(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.m=e,l.c=o,l.d=function(e,t,r){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(l.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(r,o,function(t){return e[t]}.bind(null,o));return r},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],i=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var p=i;c.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"0809":function(e,t,r){},"19ae":function(e,t,r){},3360:function(e,t,r){},4035:function(e,t,r){},4228:function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);var o=r("7a23");function n(e,t,r,n,c,l){const a=Object(o["resolveComponent"])("Picker"),i=Object(o["resolveComponent"])("Editor");return c.src?(Object(o["openBlock"])(),Object(o["createBlock"])(i,{key:1,src:c.src},null,8,["src"])):(Object(o["openBlock"])(),Object(o["createBlock"])(a,{key:0,onPaste:t[0]||(t[0]=e=>l.onPaste(e)),errorMsg:c.errorMsg,"onFile:changed":l.onChange},null,8,["errorMsg","onFile:changed"]))}const c=e=>(Object(o["pushScopeId"])("data-v-69fbbba3"),e=e(),Object(o["popScopeId"])(),e),l={id:"main-box"},a={id:"prepare-box"},i=Object(o["createTextVNode"])(" 粘贴或拖拽图片至此，或从本地图片中 "),s=c(()=>Object(o["createElementVNode"])("label",{onclick:"document.querySelector('#image-file').click();"},"选取...",-1)),p={key:0,id:"error-box"};function d(e,t,r,n,c,d){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",l,[Object(o["createElementVNode"])("div",a,[i,s,Object(o["createElementVNode"])("input",{type:"file",id:"image-file",accept:"image/*",title:"选择图片",onChange:t[0]||(t[0]=t=>e.$emit("file:changed",t.target))},null,32)]),r.errorMsg?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",p,Object(o["toDisplayString"])(r.errorMsg),1)):Object(o["createCommentVNode"])("",!0)])}var m={name:"Picker",props:{errorMsg:Error},emits:["file:changed"]},b=(r("e61e"),r("6b0d")),u=r.n(b);const j=u()(m,[["render",d],["__scopeId","data-v-69fbbba3"]]);var O=j;const g={id:"cropperjs-box"},h=["src"];function v(e,t,r,n,c,l){const a=Object(o["resolveComponent"])("Loading"),i=Object(o["resolveComponent"])("Previewer"),s=Object(o["resolveComponent"])("Scanner"),p=Object(o["resolveComponent"])("Toolbar");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",g,[Object(o["createElementVNode"])("img",{id:"image",src:r.src,alt:"an image",onError:t[0]||(t[0]=(...e)=>l.onError&&l.onError(...e))},null,40,h)]),Object(o["withDirectives"])(Object(o["createVNode"])(a,null,null,512),[[o["vShow"],c.loading]]),c.cropStatus.previewUrl?(Object(o["openBlock"])(),Object(o["createBlock"])(i,{key:0,previewUrl:c.cropStatus.previewUrl},null,8,["previewUrl"])):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(s,{croppedData:c.croppedData,imageData:c.imageData},null,8,["croppedData","imageData"]),Object(o["createVNode"])(p,{cropStatus:c.cropStatus,onDelete:l.onDelete,onClear:l.onClear,onPreview:l.onPreview,onExport:l.onExport,"onDrag:mode":l.onDragMode,"onAspectratio:set":l.onAspectRatioSet,onZoom:l.onZoom,onRotate:l.onRotate,onScale:l.onScale,"onCropbox:move":l.onCropBoxMove,"onCropbox:resize":l.onCropBoxResize},null,8,["cropStatus","onDelete","onClear","onPreview","onExport","onDrag:mode","onAspectratio:set","onZoom","onRotate","onScale","onCropbox:move","onCropbox:resize"])],64)}var E=r("bab4"),w=r.n(E);const N=e=>(Object(o["pushScopeId"])("data-v-51a355a2"),e=e(),Object(o["popScopeId"])(),e),f={class:"outer"},V=N(()=>Object(o["createElementVNode"])("div",{class:"loading"},[Object(o["createElementVNode"])("span",null,"Loading")],-1)),k=[V];function x(e,t,r,n,c,l){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",f,k)}var S={name:"Loading"};r("de21");const C=u()(S,[["render",x],["__scopeId","data-v-51a355a2"]]);var D=C;const y={class:"preview-box"},$={id:"previewer"},B=["src"];function z(e,t,r,n,c,l){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",y,[Object(o["createElementVNode"])("div",$,[Object(o["createElementVNode"])("img",{src:r.previewUrl,alt:"预览"},null,8,B)])])}var M={name:"Previewer",props:{previewUrl:String}};r("fef0");const P=u()(M,[["render",z],["__scopeId","data-v-85651772"]]);var R=P;const U=e=>(Object(o["pushScopeId"])("data-v-60580ea2"),e=e(),Object(o["popScopeId"])(),e),_={key:0,id:"image-data"},I=U(()=>Object(o["createElementVNode"])("label",null,"About Image",-1)),A={key:1,id:"cropped-data"},L=U(()=>Object(o["createElementVNode"])("label",null,"Cropped Data",-1));function F(e,t,r,n,c,l){return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[r.imageData?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",_,[I,Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,"W, H: "+Object(o["toDisplayString"])(r.imageData.naturalWidth)+", "+Object(o["toDisplayString"])(r.imageData.naturalHeight),1),Object(o["createElementVNode"])("li",null,"AR: "+Object(o["toDisplayString"])(r.imageData.aspectRatio.toFixed(3)),1)])])):Object(o["createCommentVNode"])("",!0),r.croppedData?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",A,[L,Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,"x, y: "+Object(o["toDisplayString"])(r.croppedData.x)+", "+Object(o["toDisplayString"])(r.croppedData.y),1),Object(o["createElementVNode"])("li",null,"W, H: "+Object(o["toDisplayString"])(r.croppedData.width)+", "+Object(o["toDisplayString"])(r.croppedData.height),1),Object(o["createElementVNode"])("li",null,"R: "+Object(o["toDisplayString"])(r.croppedData.rotate),1),Object(o["createElementVNode"])("li",null,"SX, SY: "+Object(o["toDisplayString"])(r.croppedData.scaleX)+", "+Object(o["toDisplayString"])(r.croppedData.scaleY),1)])])):Object(o["createCommentVNode"])("",!0)],64)}var T={name:"Scanner",props:{imageData:Object,croppedData:Object}};r("ed74");const q=u()(T,[["render",F],["__scopeId","data-v-60580ea2"]]);var H=q;const X=e=>(Object(o["pushScopeId"])("data-v-268f81b6"),e=e(),Object(o["popScopeId"])(),e),Y={class:"toolbar top"},Z={class:"toolbar middle"},W=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),J=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),Q=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),G=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),K=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),ee=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),te=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),re=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),oe=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),ne=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),ce=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),le=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),ae=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),ie=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),se=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),pe=X(()=>Object(o["createElementVNode"])("span",null,null,-1)),de={class:"toolbar bottom"},me={class:"toolbar ruler"};function be(e,t,r,n,c,l){return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Y,[Object(o["createElementVNode"])("i",{title:"删除",onClick:t[0]||(t[0]=t=>e.$emit("delete")),class:"ri-xl ri-delete-bin-line"}),Object(o["createElementVNode"])("i",{title:"撤销",onClick:t[1]||(t[1]=t=>e.$emit("clear")),class:"ri-xl ri-arrow-go-back-line"}),Object(o["createElementVNode"])("i",{title:"预览",onClick:t[2]||(t[2]=t=>e.$emit("preview")),class:Object(o["normalizeClass"])(`ri-xl ri-eye-${r.cropStatus.previewUrl?"close-":""}line`)},null,2),Object(o["createElementVNode"])("i",{title:"导出",onClick:t[3]||(t[3]=t=>e.$emit("export")),class:"ri-xl ri-download-2-line"})],512),[[o["vShow"],!r.cropStatus.cropping]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Z,[W,J,Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微上扩",class:"ri-xl ri-arrow-up-line",onClick:t[4]||(t[4]=t=>e.$emit("cropbox:resize","vertical",0-c.span,c.span))}),Object(o["createElementVNode"])("i",{title:"轻微下裁",class:"ri-xl ri-arrow-down-line",onClick:t[5]||(t[5]=t=>e.$emit("cropbox:resize","vertical",c.span,0-c.span))})]),Q,G,K,ee,Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微上移",class:"ri-xl ri-arrow-up-circle-line",onClick:t[6]||(t[6]=t=>e.$emit("cropbox:move",0,0-c.span))})]),te,re,Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微左扩",class:"ri-xl ri-arrow-left-line",onClick:t[7]||(t[7]=t=>e.$emit("cropbox:resize","horizontal",0-c.span,c.span))}),Object(o["createElementVNode"])("i",{title:"轻微右裁",class:"ri-xl ri-arrow-right-line",onClick:t[8]||(t[8]=t=>e.$emit("cropbox:resize","horizontal",c.span,0-c.span))})]),Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微左移",class:"ri-xl ri-arrow-left-circle-line",onClick:t[9]||(t[9]=t=>e.$emit("cropbox:move",0-c.span,0))})]),Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微左旋",class:"ri-xl ri-anticlockwise-2-line",onClick:t[10]||(t[10]=t=>e.$emit("rotate",c.span))}),Object(o["createElementVNode"])("i",{title:"轻微右旋",class:"ri-xl ri-clockwise-2-line",onClick:t[11]||(t[11]=t=>e.$emit("rotate",0-c.span))})]),Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微右移",class:"ri-xl ri-arrow-right-circle-line",onClick:t[12]||(t[12]=t=>e.$emit("cropbox:move",c.span,0))})]),Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微左裁",class:"ri-xl ri-arrow-left-line",onClick:t[13]||(t[13]=t=>e.$emit("cropbox:resize","horizontal",0,0-c.span))}),Object(o["createElementVNode"])("i",{title:"轻微右扩",class:"ri-xl ri-arrow-right-line",onClick:t[14]||(t[14]=t=>e.$emit("cropbox:resize","horizontal",0,c.span))})]),oe,ne,Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微下移",class:"ri-xl ri-arrow-down-circle-line",onClick:t[15]||(t[15]=t=>e.$emit("cropbox:move",0,c.span))})]),ce,le,ae,ie,Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("i",{title:"轻微上裁",class:"ri-xl ri-arrow-up-line",onClick:t[16]||(t[16]=t=>e.$emit("cropbox:resize","vertical",0,0-c.span))}),Object(o["createElementVNode"])("i",{title:"轻微下扩",class:"ri-xl ri-arrow-down-line",onClick:t[17]||(t[17]=t=>e.$emit("cropbox:resize","vertical",0,c.span))})]),se,pe],512),[[o["vShow"],!r.cropStatus.cropping&&c.more]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",de,["move"!=r.cropStatus.dragMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("i",{key:0,title:"移动",onClick:t[18]||(t[18]=t=>e.$emit("drag:mode","move")),class:"ri-xl ri-drag-move-2-line"})):Object(o["createCommentVNode"])("",!0),"crop"!=r.cropStatus.dragMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("i",{key:1,title:"裁剪",onClick:t[19]||(t[19]=t=>e.$emit("drag:mode","crop")),class:"ri-xl ri-crop-line"})):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("i",{title:"方形",onClick:t[20]||(t[20]=t=>e.$emit("aspectratio:set",(c.square=!c.square)?1:NaN)),class:Object(o["normalizeClass"])([{active:c.square},"ri-xl ri-shape-2-line"])},null,2),Object(o["createElementVNode"])("i",{title:"放大",onClick:t[21]||(t[21]=t=>e.$emit("zoom",.1)),class:"ri-xl ri-zoom-in-line"}),Object(o["createElementVNode"])("i",{title:"缩小",onClick:t[22]||(t[22]=t=>e.$emit("zoom",-.1)),class:"ri-xl ri-zoom-out-line"}),Object(o["createElementVNode"])("i",{title:"左旋",onClick:t[23]||(t[23]=t=>e.$emit("rotate",-45)),class:"ri-xl ri-anticlockwise-line"}),Object(o["createElementVNode"])("i",{title:"右旋",onClick:t[24]||(t[24]=t=>e.$emit("rotate",45)),class:"ri-xl ri-clockwise-line"}),Object(o["createElementVNode"])("i",{title:"倒置",onClick:t[25]||(t[25]=t=>e.$emit("scale","x")),class:"ri-xl ri-arrow-left-right-line"}),Object(o["createElementVNode"])("i",{title:"翻转",onClick:t[26]||(t[26]=t=>e.$emit("scale","y")),class:"ri-xl ri-arrow-up-down-line"}),Object(o["createElementVNode"])("i",{title:"更多",class:Object(o["normalizeClass"])([{active:c.more},"ri-xl ri-tools-line"]),onClick:t[27]||(t[27]=e=>c.more=!c.more)},null,2),Object(o["createElementVNode"])("i",{title:"对比",class:"ri-xl ri-contrast-drop-line",onClick:t[28]||(t[28]=(...e)=>l.setContrast&&l.setContrast(...e))})],512),[[o["vShow"],!r.cropStatus.cropping]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",me,[Object(o["createElementVNode"])("i",{class:"ri-xl ri-ruler-line",title:"标尺",onClick:t[29]||(t[29]=(...e)=>l.changeSpan&&l.changeSpan(...e))}," x "+Object(o["toDisplayString"])(c.span),1)],512),[[o["vShow"],!r.cropStatus.cropping&&c.more]])],64)}var ue={name:"Toolbar",props:{cropStatus:{type:Object,default:()=>({cropping:!1,dragMode:"move",previewUrl:null})}},emits:["delete","clear","preview","export","drag:mode","zoom","rotate","scale","aspectratio:set","cropbox:move","cropbox:resize"],data(){return{square:!1,more:!1,span:1,contrast:!1}},methods:{changeSpan(){1===this.span?this.span=5:5===this.span?this.span=10:this.span=1},setContrast(){this.contrast=!this.contrast;let e=this.contrast?"rgb(245 241 241)":"";document.querySelectorAll("i").forEach(t=>{t.style.background=e})}}};r("7149");const je=u()(ue,[["render",be],["__scopeId","data-v-268f81b6"]]);var Oe=je;r("4604"),r("ab05");w.a.setDefaults({autoCrop:!1,viewMode:2,background:!1,dragMode:"move"});var ge={name:"Editor",props:{src:String},components:{Loading:D,Previewer:R,Scanner:H,Toolbar:Oe},data(){return{loading:!0,cropper:null,imageData:null,croppedData:null,cropStatus:{cropping:!1,dragMode:"move",previewUrl:null}}},mounted(){const e=document.getElementById("image");let t=this,r=this.cropper=new w.a(e,{ready(){t.imageData=r.getImageData(),t.loading=!1,r.crop()},crop(){t.croppedData=r.getData(!0)},cropmove(){t.cropStatus.cropping=!0},cropend(){t.cropStatus.cropping=!1}})},methods:{onError(){this.loading=!1,this.cropper.destroy(),this.$parent.error(new Error("图片资源错误或加载失败: "+this.src))},onDelete(){this.cropper&&this.cropper.destroy(),this.$parent.clear()},onClear(){this.cropper.clear(),this.closePreview()},closePreview(){this.cropStatus.previewUrl&&(this.cropStatus.previewUrl=null)},onPreview(){if(this.cropStatus.previewUrl)this.cropStatus.previewUrl=null;else{let e=this.cropper.getCroppedCanvas({imageSmoothingEnabled:!0,imageSmoothingQuality:"high"});this.cropStatus.previewUrl=e.toDataURL()}},onExport(){let e=this.cropper.getCroppedCanvas({imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}).toDataURL(),t=document.createElement("a");t.download="cropped",t.href=e,t.click()},onDragMode(e){this.cropper.setDragMode(e),this.cropStatus.dragMode=e},onAspectRatioSet(e){this.cropper.setAspectRatio(e)},onZoom(e){this.cropper.zoom(e)},onRotate(e){this.cropper.rotate(e)},onScale(e){"x"===e?this.cropper.scaleX(-1*this.croppedData.scaleX):"y"===e&&this.cropper.scaleY(-1*this.croppedData.scaleY)},onCropBoxMove(e,t){let r=this.croppedData;r.x=r.x+e,r.y=r.y+t,this.cropper.setData(r)},onCropBoxResize(e,t,r){let o=this.croppedData;"vertical"===e?(o.y=o.y+t,o.height=o.height+r):"horizontal"===e&&(o.x=o.x+t,o.width=o.width+r),this.cropper.setData(o)}}};r("fccf");const he=u()(ge,[["render",v],["__scopeId","data-v-d992271e"]]);var ve=he,Ee={name:"App",components:{Picker:O,Editor:ve},data(){return{src:"/static/picture.jpg",errorMsg:null}},mounted(){let e=window.location.search.substr(1);e&&(this.src=e)},methods:{clear(){this.src=null},error(e){this.errorMsg=e,this.src=null},onPaste(e){const{items:t}=e.clipboardData||window.clipboardData;e.preventDefault(),t&&t.length>0&&new Promise((e,r)=>{const o=Array.from(t).pop(),n=new Error("请粘贴图片文件或URL");"file"===o.kind?e(o.getAsFile()):"string"===o.kind?o.getAsString(t=>{if(/^(?:https?|data):/.test(t)){const o=new XMLHttpRequest,c=()=>{r(n)};o.onabort=c,o.onerror=c,o.ontimeout=c,o.onprogress=()=>{/^image\/\w+$/.test(o.getResponseHeader("content-type"))||o.abort()},o.onload=()=>{e(o.response)},o.open("GET",t,!0),o.responseType="blob",o.send()}else r(n)}):r(n)}).then(t=>this.read(t,e).then(e=>{this.src=e.url})).catch(this.error)},read(e,t){return new Promise((r,o)=>{e?/^image\/\w+$/.test(e.type)?URL?r({loaded:!0,name:e.name,type:e.type,url:URL.createObjectURL(e)}):o(new Error("您的浏览器不支持此操作。")):o(new Error(`请 ${t?t.type:"选择"}图片文件。`)):r()})},onChange(e){this.errorMsg=null;let t=e.files[0];if(!t)return;let r=new FileReader;r.onload=e=>{this.src=e.target.result},r.readAsDataURL(t)}}};const we=u()(Ee,[["render",n]]);var Ne=we;const{createApp:fe}=r("7a23");fe(Ne).mount("#app")},7149:function(e,t,r){"use strict";r("4228")},de21:function(e,t,r){"use strict";r("19ae")},deed:function(e,t,r){},e61e:function(e,t,r){"use strict";r("4035")},ed74:function(e,t,r){"use strict";r("deed")},fccf:function(e,t,r){"use strict";r("3360")},fef0:function(e,t,r){"use strict";r("0809")}});
//# sourceMappingURL=app.b784f186.js.map